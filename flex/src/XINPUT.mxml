<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
                       xmlns:s="library://ns.adobe.com/flex/spark"
                       xmlns:mx="library://ns.adobe.com/flex/mx"
                       width="67" height="180"
                       addedToStage="windowedapplication1_addedToStageHandler(event)"
                       close="windowedapplication1_closeHandler(event)">
    
    <fx:Script>
        <![CDATA[
            
            
            import com.amdevcorp.FREXInput.FREXInputLib;
            import com.amdevcorp.FREXInput.XINPUT_GAMEPAD;
            private var _xinput:FREXInputLib;
            private var gp:XINPUT_GAMEPAD;
            private var t:Timer;
            protected function button1_clickHandler(event:MouseEvent):void
            {
                t.start();
                
            }
            
            protected function windowedapplication1_addedToStageHandler(event:Event):void
            {
                t = new Timer(500)
                t.addEventListener(TimerEvent.TIMER,onTimer);   
                _xinput = new FREXInputLib();
                _xinput.activate()
                
                t.start();
            }
            protected function onTimer (e:Event = null):void{
                try{
                    gp = _xinput.XInputGetState(0);
                    trace(gp.GUIDE_BTN_PRESSED);                    
                } catch (err:Error) {
                    trace("LE BIG FAIL "+ err.errorID );
                }

            }
            protected function windowedapplication1_closeHandler(event:Event):void
            {
                // TODO Auto-generated method stub
                _xinput.dispose();
                
            }
            
            protected function setBtn_clickHandler(event:MouseEvent):void
            {
                
                var lVibration:uint = lRumble.value 
                var rVibration:uint = rRumble.value
                
                _xinput.XInputSetState(0,lVibration,rVibration);    
            }
            
        ]]>
    </fx:Script>
    
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <s:VSlider id="lRumble" x="10" y="10" width="20" maximum="65535" minimum="0"/>
    <s:VSlider id="rRumble" x="38" y="10" width="20" maximum="65535" minimum="0"/>
    <s:Button id="setBtn" x="10" y="118" width="49" label="Set" click="setBtn_clickHandler(event)"/>
</s:WindowedApplication>
